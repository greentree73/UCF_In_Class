<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API HTTP Lab - Solution</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
        }
        .solution-note {
            background-color: #d4edda;
            border-left: 4px solid #28a745;
            padding: 15px;
            margin: 20px 0;
            border-radius: 5px;
        }
        .button-container {
            text-align: center;
            margin: 30px 0;
        }
        button {
            background-color: #007acc;
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 16px;
            border-radius: 5px;
            cursor: pointer;
            margin: 10px;
            transition: background-color 0.3s;
        }
        button:hover {
            background-color: #005999;
        }
        button:disabled {
            background-color: #ccc;
            cursor: not-allowed;
        }
        button.error-demo {
            background-color: #dc3545;
        }
        button.error-demo:hover {
            background-color: #c82333;
        }
        .output {
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 5px;
            padding: 20px;
            margin: 20px 0;
            font-family: 'Courier New', monospace;
            white-space: pre-wrap;
            max-height: 500px;
            overflow-y: auto;
        }
        .instructions {
            background-color: #e7f3ff;
            border-left: 4px solid #007acc;
            padding: 15px;
            margin: 20px 0;
        }
        .success { color: #28a745; }
        .error { color: #dc3545; }
        .info { color: #17a2b8; }
        .warning { color: #ffc107; }
        .timing {
            background-color: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 10px;
            margin: 10px 0;
            font-size: 14px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üèÜ API HTTP Lab - Solution</h1>
        
        <div class="solution-note">
            <h3>üí° Solution Features:</h3>
            <ul>
                <li><strong>Enhanced Error Handling:</strong> Demonstrates proper error scenarios</li>
                <li><strong>Performance Timing:</strong> Shows request duration measurement</li>
                <li><strong>Multiple API Examples:</strong> Different endpoints for comparison</li>
                <li><strong>Response Analysis:</strong> Detailed response inspection</li>
            </ul>
        </div>

        <div class="instructions">
            <h3>üìã Enhanced Instructions:</h3>
            <ol>
                <li>Open Developer Tools (F12) ‚Üí Network tab</li>
                <li>Try each button and examine the different responses</li>
                <li>Compare successful requests with error scenarios</li>
                <li>Note the timing differences between endpoints</li>
                <li>Examine response headers and payload sizes</li>
            </ol>
        </div>

        <div class="button-container">
            <button id="fetchPostBtn" onclick="fetchPost()">Fetch Post Data</button>
            <button id="fetchUserBtn" onclick="fetchUser()">Fetch User Data</button>
            <button id="fetchPhotosBtn" onclick="fetchPhotos()">Fetch Photos List</button>
            <button id="errorBtn" onclick="demonstrateError()" class="error-demo">Demonstrate 404 Error</button>
            <button id="clearBtn" onclick="clearOutput()">Clear Output</button>
        </div>

        <div id="timing" class="timing" style="display: none;">
            Request completed in: <span id="timingValue">0</span>ms
        </div>

        <div id="output" class="output">
            Click any button above to see API responses and examine the Network tab...\n
        </div>
    </div>

    <script>
        let requestStartTime = 0;

        // Output logging function with enhanced timing
        function log(message, type = 'info') {
            const output = document.getElementById('output');
            const timestamp = new Date().toLocaleTimeString();
            const colorClass = type === 'error' ? 'error' : 
                              type === 'success' ? 'success' : 
                              type === 'warning' ? 'warning' : 'info';
            
            if (output) {
                output.innerHTML += `<span class="${colorClass}">[${timestamp}] ${message}</span>\n`;
                output.scrollTop = output.scrollHeight;
            }
        }

        function showTiming(duration) {
            const timingDiv = document.getElementById('timing');
            const timingValue = document.getElementById('timingValue');
            timingValue.textContent = duration;
            timingDiv.style.display = 'block';
            
            // Hide after 3 seconds
            setTimeout(() => {
                timingDiv.style.display = 'none';
            }, 3000);
        }

        function setButtonLoading(buttonId, loading = true) {
            const button = document.getElementById(buttonId);
            button.disabled = loading;
            if (loading) {
                button.dataset.originalText = button.textContent;
                button.textContent = 'Loading...';
            } else {
                button.textContent = button.dataset.originalText || button.textContent;
            }
        }

        async function fetchPost() {
            setButtonLoading('fetchPostBtn', true);
            requestStartTime = performance.now();
            
            log('üöÄ Fetching post data from JSONPlaceholder API...', 'info');
            
            try {
                const response = await fetch('https://jsonplaceholder.typicode.com/posts/1');
                const duration = Math.round(performance.now() - requestStartTime);
                
                log(`üìä Response Status: ${response.status} (${response.statusText})`, 'info');
                log(`‚è±Ô∏è Request Duration: ${duration}ms`, 'info');
                log(`üìç Response URL: ${response.url}`, 'info');
                log(`üìã Content Type: ${response.headers.get('content-type')}`, 'info');
                log('', 'info');
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                const post = await response.json();
                
                log('‚úÖ Success! Post data received:', 'success');
                log('‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ', 'success');
                log(`üìù Post ID: ${post.id}`, 'success');
                log(`üë§ User ID: ${post.userId}`, 'success');
                log(`üì∞ Title: ${post.title}`, 'success');
                log(`üìÑ Body: ${post.body.substring(0, 100)}...`, 'success');
                log('‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ', 'success');
                
                showTiming(duration);
                
            } catch (error) {
                const duration = Math.round(performance.now() - requestStartTime);
                log('‚ùå Error fetching post:', 'error');
                log(`   Error message: ${error.message}`, 'error');
                showTiming(duration);
            } finally {
                setButtonLoading('fetchPostBtn', false);
            }
        }

        async function fetchUser() {
            setButtonLoading('fetchUserBtn', true);
            requestStartTime = performance.now();
            
            log('üë§ Fetching user data...', 'info');
            
            try {
                const response = await fetch('https://jsonplaceholder.typicode.com/users/1');
                const duration = Math.round(performance.now() - requestStartTime);
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                const user = await response.json();
                
                log('‚úÖ User data received:', 'success');
                log(`üë§ Name: ${user.name}`, 'success');
                log(`üìß Email: ${user.email}`, 'success');
                log(`üåê Website: ${user.website}`, 'success');
                log(`üè¢ Company: ${user.company.name}`, 'success');
                
                showTiming(duration);
                
            } catch (error) {
                const duration = Math.round(performance.now() - requestStartTime);
                log('‚ùå Error fetching user:', 'error');
                log(`   Error message: ${error.message}`, 'error');
                showTiming(duration);
            } finally {
                setButtonLoading('fetchUserBtn', false);
            }
        }

        async function fetchPhotos() {
            setButtonLoading('fetchPhotosBtn', true);
            requestStartTime = performance.now();
            
            log('üì∏ Fetching photos list (first 5)...', 'info');
            
            try {
                const response = await fetch('https://jsonplaceholder.typicode.com/photos?_limit=5');
                const duration = Math.round(performance.now() - requestStartTime);
                
                log(`üìä Response size: ${response.headers.get('content-length') || 'Unknown'} bytes`, 'info');
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                const photos = await response.json();
                
                log('‚úÖ Photos list received:', 'success');
                photos.forEach((photo, index) => {
                    log(`üì∏ ${index + 1}. "${photo.title}" (ID: ${photo.id})`, 'success');
                });
                
                showTiming(duration);
                
            } catch (error) {
                const duration = Math.round(performance.now() - requestStartTime);
                log('‚ùå Error fetching photos:', 'error');
                log(`   Error message: ${error.message}`, 'error');
                showTiming(duration);
            } finally {
                setButtonLoading('fetchPhotosBtn', false);
            }
        }

        async function demonstrateError() {
            setButtonLoading('errorBtn', true);
            requestStartTime = performance.now();
            
            log('üß™ Demonstrating 404 error with invalid endpoint...', 'warning');
            
            try {
                const response = await fetch('https://jsonplaceholder.typicode.com/posts/999999');
                const duration = Math.round(performance.now() - requestStartTime);
                
                log(`üìä Response Status: ${response.status} (${response.statusText})`, 'warning');
                
                if (!response.ok) {
                    log('‚ö†Ô∏è Expected error occurred - this is normal!', 'warning');
                    log(`   Status: ${response.status}`, 'warning');
                    log(`   Status Text: ${response.statusText}`, 'warning');
                    
                    // Try to read the response anyway
                    const errorResponse = await response.json();
                    log(`   Response body: ${JSON.stringify(errorResponse)}`, 'warning');
                } else {
                    // This shouldn't happen with the endpoint we're using
                    const data = await response.json();
                    log('ü§î Unexpected success:', 'info');
                    log(JSON.stringify(data, null, 2), 'info');
                }
                
                showTiming(duration);
                
            } catch (error) {
                const duration = Math.round(performance.now() - requestStartTime);
                log('‚ùå Network error (this is also normal for error demos):', 'error');
                log(`   Error message: ${error.message}`, 'error');
                showTiming(duration);
            } finally {
                setButtonLoading('errorBtn', false);
            }
        }

        function clearOutput() {
            const output = document.getElementById('output');
            if (output) {
                output.innerHTML = 'Click any button above to see API responses and examine the Network tab...\n';
            }
        }

        // Auto-focus for better UX
        window.addEventListener('load', () => {
            log('üéØ Solution Ready! Network tab shows enhanced request details:', 'info');
            log('   ‚Ä¢ Response timing and payload sizes', 'info');
            log('   ‚Ä¢ Multiple endpoint comparisons', 'info');
            log('   ‚Ä¢ Error handling demonstrations', 'info');
            log('   ‚Ä¢ Performance analysis capabilities', 'info');
        });
    </script>
</body>
</html>